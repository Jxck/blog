---
title: "🔥HonoXでブログを作り直した🔥"
description: "HonoXでブログを作り直しました"
date: "2024/03/07"
published: true
---

# 🔥HonoXでブログを作り直した🔥
:
## Intro

今回自分のブログをNext.jsからHonoXに書き換えをしました。あんまりまだ使ってる人いないと思うので、今後使ってみたい向けにブログとして残しておきます。

## honox-blog-templeteを作った

最初に今後HonoXを使っていきたい方向けに[honox-blog-templete](https://github.com/yossydev/honox-blog-templete)というテンプレートリポジトリを作りました。

基本的には[yusukebe](https://github.com/yusukebe)さんの[honox mdx exmaple](https://github.com/yusukebe/honox-examples/tree/main/projects/mdx)で事足りるのですが、技術ブログを書きたい人はシンタックスハイライトの設定をしたり、フォーマッターの設定などもしたいともうので、そういったものを設定してあるので、サクッとブログを作りたい方は使ってみてください！

```bash
$ npm run create:post
```

を実行すると対話形式でブログのテンプレートを作れます！あとはブログを書いて、Cloudflare pagesなりにデプロイをすると完成です！UIはお好みでどうぞ！

## 感想

### 1. mdxがそのまま使えるのありがたい

[https://github.com/honojs/honox?tab=readme-ov-file#mdx](https://github.com/honojs/honox?tab=readme-ov-file#mdx)に書いてある内容です。

自分の場合は`/app/posts`配下にmdxファイルをおいているんですが、ビルドするとhtmlファイルに変換されるので、そのままブラウザに表示させることができます。追加の設定もほぼいらないので、びっくりするほど簡単でした。

### 2. Hooksが使えるのありがたい

hono/jsxがReactと互換性があるため、Hooksを使うことができます。([https://hono.dev/guides/jsx-dom#hooks-compatible-with-react](https://hono.dev/guides/jsx-dom#hooks-compatible-with-react))

そのため、今回隠れた追加機能としていいね機能を追加したんですが、これにdebounce機能を用いる際に[zenn](https://zenn.dev/luvmini511/articles/4924cc4cf19bc9)にあった参考のhooksをそのまま使うことができ、とても楽でした。

```ts
import { useEffect, useState } from "hono/jsx";

export function useDebounce(value: number, delay: number) {
  const [debouncedValue, setDebouncedValue] = useState(value);

  useEffect(() => {
    const timer = setTimeout(() => {
      setDebouncedValue(value);
    }, delay);
    return () => {
      clearTimeout(timer);
    };
  }, [value, delay]);

  return debouncedValue;
}
```

### 3. Islandコンポーネントが_renderer.tsxで使うとscriptが読み込まれない

今回[いいね機能](https://github.com/yossydev/blog/blob/main/app/islands/LikeButton.tsx)と[Xへのシェアとフォローのボタン](https://github.com/yossydev/blog/blob/main/app/islands/SnsButton.tsx)はisland配下に置いて、全てのブログページ下部で表示させるために`_renderer.tsx`配下に置いています。

この場合表示はされるんですが、[honox/serverのScirptコンポーネント](https://github.com/honojs/honox/blob/main/src/server/components/script.tsx)では使用上`HasIsland`がtrueになった場合に本番環境でscirptが読み込まれるようになる仕様になっているみたいでした。

```tsx
export const Script: FC<Options> = async (options) => {
  const src = options.src
  if (options.prod ?? import.meta.env.PROD) {
    let manifest: Manifest | undefined = options.manifest
    if (!manifest) {
      const MANIFEST = import.meta.glob<{ default: Manifest }>('/dist/.vite/manifest.json', {
        eager: true,
      })
      for (const [, manifestFile] of Object.entries(MANIFEST)) {
        if (manifestFile['default']) {
          manifest = manifestFile['default']
          break
        }
      }
    }
    if (manifest) {
      const scriptInManifest = manifest[src.replace(/^\//, '')]
      if (scriptInManifest) {
        return (
          <HasIslands>
            <script
              type='module'
              async={!!options.async}
              src={`/${scriptInManifest.file}`}
            ></script>
          </HasIslands>
        )
      }
    }
    return <></>
  } else {
    return <script type='module' async={!!options.async} src={src}></script>
  }
}
```

scriptが読み込まれないので、インタクションが発生しても何も起きない状態が発生しません。
そのため、`<HasIslands>`で囲まないようにした[Scriptコンポーネント](https://github.com/yossydev/blog/blob/main/app/libs/honox/Script.tsx)を自分の方で用意することにしました。

ただ絶対この方法良くないと思うので、なんかいい方法あれば教えていただきたいです🙇‍♂️

[https://github.com/honojs/honox/issues/46](https://github.com/honojs/honox/issues/46) ← 今回のこちらの内容のissue立っていました。

## まとめ

個人的には開発体験良くて、Cloudflare pagesへのデプロイも爆速だったので流行って欲しいなと思います！
あと今回npm使ったけどbunにしてみたいし、もうちょっとislandの恩恵を感じられるようなインタラクション多めのアプリでも採用してみたいです！

ぜひ皆さんもHonoX使ってみてくださいー！！🔥
